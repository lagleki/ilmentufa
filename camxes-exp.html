<!doctype html>
<html>
<head>
  <title>la spagetufa</title>
  <style>
    .optiio {
      font-size: 90%;
    }
    .optiio * {
      vertical-align: top;
      text-align: left;
      font-family: "Droid Sans", "Liberation Sans", "Arial", sans-serif;
    }
    .optiio td:not(:first-child) {
      border-left: solid silver 1pt;
    }
    .optiio label {
      display: block;
    }
  </style>
</head>
<body>
<meta charset='utf-8' />

<span style="font: 15px arial, sans-serif;">ko ciska lo lojbo uenzi .i ca gi do ciska gi mi genturfa'i</span>
<br /><br />

<form id="form1" name="form1" method="post" action="" style="width:100%">
  <textarea id="input_textarea" style="width:100%" rows="8" autofocus></textarea>
  <br />
  <span style="font: 15px arial, sans-serif;">Output mode: </span>
  <!--
			"  .i zo'oi  +brackets  noi ditfaulte zo'u lo te pruce cu se melgau je nai cu se fanva\n" +
			"  .i zo'oi  +gloss                   zo'u lo skami cu spoja\n" + //te pruce cu gloso fi lo glibau (to na sai bredi toi)\n" +
			"  .i zo'oi  +raw                     zo'u lo te pruce na se melgau\n" +
			"  .i zo'oi  +s                       zo'u lo cmene be lo selma'o cu pagbu\n" +
			"  .i zo'oi  +f         noi ditfaulte zo'u lo famyma'o poi jai se rivbi cu pagbu\n" +
			"  .i zo'oi  +p                       zo'u lo tersumpoi pe lo selbrisle cu pagbu\n" +
			"  .i zo'oi  +k         noi ditfaulte zo'u zo'oi / jbini lo se porsi be ro rafsi relgrama\n" +
			"  .i zo'oi  +voi       noi ditfaulte zo'u zo voi cmavo ma'oi nu je nai ma'oi noi\n" +
			"  .i zo'oi  +ckt                     zo'u ro mei'e  zo ce joi zo ce'u  zo ki joi zo ke'a  zo tau joi zo tu'a\n" +
			"                                          cu voi lo se gunma be ke'a cu bastysi \n" +
			"  .i zo'oi  +du                      zo'u zo du jo'u zo du'u bastysi\n" +
			"  .i zo'oi  +su                      zo'u zo su jo'u zo su'o bastysi .i ma'oi su se cmene zo su'o\n" +
			"  .i zo'oi  +buhu      noi ditfaulte zo'u ro mei'e zo bu zo bu'u zo zai cu cmavo lo fadni\n" +
			"  .i zo'oi  +bu                      zo'u zo bu jo'u zo bu'u bastysi\n" +
			"  .i zo'oi  +zai                     zo'u zo zai cmavo ma'oi pu je nai ma'oi lau ja bo ma'oi ce'a\n" +
			"  .i zo'oi  +po                      zo'u ma'oi lo'oi se cmene zo po noi cmavo vo'a je nai ma'oi goi\n" +
			"                                          .i je ma'oi ku'au se cmene zo po'e noi cmavo vo'a je nai ma'oi goi \n" +
			"  .i zo'oi  +koi                     zo'u zo koi cmavo ma'oi ui je nai ma'oi pu\n" +
			"  .i zo'oi  +lau                     zo'u zo lau cmavo ma'oi ko'a je nai ma'oi lau noi se cmene zo ce'a\n" +
			"  .i zo'oi  +lerfu                   zo'u na ka'e ku su'o lerpoi cu se pagbu ge su'o vlale'u gi su'o nacle'u \n" +
			"  .i zo'oi  +rafcau                  zo'u lo se gu rafcla valstuge'a gi rafcau valturge'a cu se pilno \n" +
			"                                          (to pa javni zo'u ro brivla da jai cuntu toi) \n" +
			"  .i zo'oi  +dujoi                   zo'u zo du cmavo ma'oi joi je nai ma'oi go'a\n" +
			"  .i zo'oi  +diftogoteha             zo'u zo si'u cmavo ma'oi ui je nai ma'oi pu\n" +
			"                                          .i je zo di'o cmavo ma'oi coi je nai ma'oi pu \n" +
			"                                          .i je zo se'e cmavo ma'oi ko'a je nai ma'oi by \n" +
			"  .i zo'oi  +cktj                    zo'u dunli lo nu pilno ro mei'e zo'oi voi zo'oi ckt zo'oi du zo'oi su\n" +
			"                                                                     zo'oi zai zo'oi lau zo'oi po zo'oi koi \n" +
			"  .i zo'oi  +zaho                    zo'u dunli lo nu pilno zo'oi cktj je zo'oi diftogoteha\n" +
  -->
  <script>
        
    var module = {};
    var process = {argv: {}};
      
  </script>
  <table class="optiio">
    <thead><th>lo jvinu be lo te pruce</th><th>lo gerna tcila</th><th>lo baukle</th></thead>
    <tbody><td id="tepruce"></td><td id="tcila"></td><td id="baukle"></td></tbody>
  </table>
  <span style="padding-left: 32px; text-align: right; font-size: 12px;">
    <a href="camxes-exp.js.peg" target="_blank">[ cpacu lo gerna sfaile ]</a>
  </span>
</form>

<div style="display:block; overflow: scroll; max-height:24em; border: solid 1px; padding: 10px; background-color: #DDDDFF;"
     height="24em">
  <pre style="white-space: pre-wrap;"><code id="parse_result" width="100%" height="100%"> </code></pre>
</div>

<script type="text/javascript" src="camxes-exp.js"></script>
<script type="text/javascript" src="camxes_preproc.js"></script>
<script type="text/javascript" src="ilmentufa_options.js"></script>
<script type="text/javascript" src="ilmentufa_postproc.js"></script>

<script>
var g_options = JSON.parse(JSON.stringify(ret));
var boxes = [];
function toggle(name, key) {
  return {
    name: name,
    get: function () { return g_options[key] },
    set: function (value) { g_options[key] = value },
  };
}
function not(toggle) {
  return {
    get: function () { return !toggle.get() },
    set: function (value) { toggle.set(!value) },
  };
}
function box(toggle) {
  var box = document.createElement("input");
  box.type = "checkbox";
  box.onchange = function () {
    toggle.set(box.checked);
    update_boxes();
    run_camxes();
  };
  box.onclick = box.onchange;
  var label = document.createElement("label");
  label.appendChild(box);
  label.appendChild(document.createTextNode(" " + toggle.name));
  return {
    box: box,
    label: label,
    update: function () {
      box.checked = toggle.get();
    }
  };
}
var output_checks = [
  {name: "lo te pruce cu fegli", get: function () { return g_options.format == "raw" }, 
                      set: function (value) { g_options.format = value ? "raw" : "brackets" },},
  toggle("viska lo selma'o cmene", "s"),
  toggle("viska lo se rivbi famyma'o", "f"),
  toggle("viska lo srana be ma'oi se", "p"),
  toggle("viska lo rafsi te sepli", "k"),
];
var c_voi = toggle("zo voi cmavo ma'oi nu", "voi"),
    c_ckt = toggle("lo'u ce ce'u ki ke'a tau tu'a le'u zo'u basti", "ckt"),
    c_du = toggle("zo du jo'u zo du'u bastysi", "du"),
    c_su = toggle("zo su jo'u zo su'o bastysi", "su"),
    c_buhu = {name: "zo bu'u zo bu zo zai zo'u fadni", get: function () { return g_options.buhu == "buhu" },
              set: function (value) { if (value) g_options.buhu = "buhu" },},
    c_bu = {name: "zo bu jo'u zo bu'u bastysi", get: function () { return g_options.buhu == "bu" },
              set: function (value) { if (value) g_options.buhu = "bu" },},
    c_zai = {name: "zo zai cmavo ma'oi pu", get: function () { return g_options.buhu == "zai" },
              set: function (value) { if (value) g_options.buhu = "zai" },},
    c_po = toggle("lo'u po po'e le'u dunli lu xu'u ku'au li'u", "po"),
    c_koi = toggle("zo koi cmavo ma'oi ui", "koi"),
    c_lau = toggle("zo lau cmavo ma'oi ko'a", "lau"),
    c_lerfu = toggle("ro lerpoi zo'u pa da lerkle", "lerfu"),
    c_rafcau = toggle("se gu rafcla valstuge'a gi rafcau valturge'a", "rafcau"),
    c_diftogoteha = toggle("lo clani cmavo cu se terpa", "diftogoteha");
var micro_checks = [c_voi, c_ckt, c_du, c_su, c_buhu, c_bu, c_zai, c_po, c_koi, c_lau, c_lerfu, c_rafcau, c_diftogoteha];
var c_fadni = {name: "fadni jbobau", 
               conds: [c_voi, c_ckt, c_du, c_su, c_bu, c_zai, c_po, c_koi, c_lau, c_lerfu, c_diftogoteha],
               get: function () { return this.conds.every(function (a) { return !a.get() }) },
               set: function (a) { if (a) { this.conds.forEach(function (b) { b.set(false) }); c_buhu.set(true) } },},
    c_cetki = {name: "cetkitaujbo", 
               conds: [c_voi, c_ckt, c_du, c_su, c_zai, c_po, c_koi, c_lau, not(c_lerfu), not(c_diftogoteha)],
               get: function () { return this.conds.every(function (a) { return a.get() }) },
               set: function (a) { if (a) { this.conds.forEach(function (b) { b.set(true) }) } },},
    /*c_xorxo = {name: "xorjbo", 
               conds: [c_voi, c_ckt, c_du, c_su, c_zai, c_po, c_koi, c_lau],
               get: function () { return this.conds.every(function (a) { return a.get() }) },
               set: function (a) { if (a) { this.conds.forEach(function (b) { b.set(true) }) } },},*/
    c_djemu = {name: "djemyjbo", 
               conds: [c_voi, c_ckt, c_du, c_su, c_zai, c_po, c_koi, c_lau, c_diftogoteha, not(c_lerfu)],
               get: function () { return this.conds.every(function (a) { return a.get() }) },
               set: function (a) { if (a) { this.conds.forEach(function (b) { b.set(true) }) } },};

var macro_checks = [c_fadni, c_cetki, /*c_xorxo,*/ c_djemu];

function add_checks(checks, container) {
  checks.forEach(function (a) {
    var thing = box(a);
    boxes.push(thing);
    container.appendChild(thing.label);
  });
}
function update_boxes() {
  boxes.forEach(function (a) { a.update() });
}

add_checks(output_checks, document.querySelector("#tepruce"));
add_checks(micro_checks, document.querySelector("#tcila"));
add_checks(macro_checks, document.querySelector("#baukle"));
update_boxes();

document.querySelector('#input_textarea').onkeyup = function () {
  run_camxes();
};

function run_camxes() {
    try {
      var input = document.querySelector('#input_textarea').value;
      input = camxes_preprocessing(input);
      var result = camxes.parse(input, g_options);
    } catch (e) {
      document.querySelector('#parse_result').textContent = e.toString();
      return;
    }
    /* We get the output mode selected in the combobox */
    /* Postprocessing â€” if mode == 0, the below function won't modify camxes' output */
    result_str = camxes_postprocessing(result, g_options);  // @camxes_postproc.js
    /* Retrieve the result */
    document.querySelector('#parse_result').textContent = result_str;
}
</script>

</body>
</html>

